<h2>ETL Technical Document</h>
<br>
<p>The purpose of this project was to compare game statistics of quarterbacks who have started in a super bowl. We hope to predict how well a starting quarterback will play in the super bowl. We analyzed and compared passer rating, overall touchdowns, interception percentage, yards per attempt, total passing yards, and completion percentage for each starting quarterback in a super bowl game from 1966 to 2020.</p>
<p>We used Pandas to scrape starting quarterbacks from a Wikipedia page and game statistics from Pro-football Reference. We converted the scraped html data to dataframes to display it and performed cleanup using Pandas. We first noticed there were characters we wanted to remove so that the player’s name would be displayed consistently across all tables. Some names were displayed with a plus symbol so to clean the data in the player column, we replaced the symbol with an empty space. We also changed the names of columns for readability: “Rate” to “Passer Rating”, “TM” to “Team”, “Int %” to “Interception Percentage”, “Y/A” to “Yards per Attempt”, and “Cmp%” to “Completion Percentage”.</p>
<p>We noticed extra characters on some of the years in the Season column as well. We only wanted the year in the table. To remove the extra characters, we first had to reference the column by the index to view the entire value. When trying to do the replace method it initially did not work. We had to reference the dataframe column and specific index of [0] to see what data was actually there. This uncovered that the space between the year and “AFL/NFL” was actually the following string “\u2009”. Once we figured that out, we were able to use the replace method.</p> 
<p>The last character of every team name had either an “n” or “a”. We only wanted to the team name in the table. In order to remove the extra character, we looped through every character in the string to remove the last character. The code we used was: [x[:-1] for x in sb_df_cleaned[“Team”]].
<p>We then used SQLAlchemy to establish a connection to Postgres and loaded each dataframe as a table. We imported seven tables: super bowl quarterbacks, passer rating, pass yards, passing touchdowns, yards per attempt, interception percent, and completion percent. We then inner joined all tables on player name to get all of the players and statistics in the same table. We noticed some quarterbacks were dropped after doing the inner join, so we inserted each of those player names and statistics into the stats table. Then reordered the table so the added names would be sorted correctly by season. We checked the table to confirm that all data is correct and exported it to a csv file.</p>
